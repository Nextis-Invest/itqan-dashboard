generator client {
  provider = "prisma-client-js"
  output   = "../../node_modules/@prisma/client-catalog"
}

datasource db {
  provider = "postgresql"
  url      = env("CATALOG_DATABASE_URL")
}

model Locale {
  id         String   @id
  name       String
  nativeName String   @map("native_name")
  direction  String   @default("ltr")
  flag       String?
  isDefault  Boolean  @default(false) @map("is_default")
  isActive   Boolean  @default(true) @map("is_active")
  sortOrder  Int      @default(0) @map("sort_order")
  createdAt  DateTime @default(now()) @map("created_at")
  updatedAt  DateTime @updatedAt @map("updated_at")

  @@map("locales")
}

model Category {
  id           String                @id @default(cuid())
  icon         String?
  color        String?
  level        Int                   @default(0)
  sortOrder    Int                   @default(0) @map("sort_order")
  isActive     Boolean               @default(true) @map("is_active")
  avgTjmMin    Int?                  @map("avg_tjm_min")
  avgTjmMax    Int?                  @map("avg_tjm_max")
  keywords     String[]              @default([])
  parentId     String?               @map("parent_id")
  createdAt    DateTime              @default(now()) @map("created_at")
  updatedAt    DateTime              @updatedAt @map("updated_at")
  parent       Category?             @relation("CategoryTree", fields: [parentId], references: [id])
  children     Category[]            @relation("CategoryTree")
  translations CategoryTranslation[]

  @@index([parentId])
  @@index([level])
  @@index([isActive])
  @@map("categories")
}

model CategoryTranslation {
  id          String   @id @default(cuid())
  categoryId  String   @map("category_id")
  locale      String
  name        String
  slug        String
  description String?
  category    Category @relation(fields: [categoryId], references: [id], onDelete: Cascade)

  @@unique([categoryId, locale])
  @@unique([locale, slug])
  @@index([locale])
  @@index([slug])
  @@map("category_translations")
}

model Skill {
  id           String             @id @default(cuid())
  isActive     Boolean            @default(true) @map("is_active")
  sortOrder    Int                @default(0) @map("sort_order")
  categoryId   String?            @map("category_id")
  createdAt    DateTime           @default(now()) @map("created_at")
  updatedAt    DateTime           @updatedAt @map("updated_at")
  translations SkillTranslation[]

  @@index([categoryId])
  @@map("skills")
}

model SkillTranslation {
  id      String @id @default(cuid())
  skillId String @map("skill_id")
  locale  String
  name    String
  slug    String
  skill   Skill  @relation(fields: [skillId], references: [id], onDelete: Cascade)

  @@unique([skillId, locale])
  @@unique([locale, slug])
  @@index([locale])
  @@map("skill_translations")
}

model SlugRedirect {
  id         String   @id @default(cuid())
  oldSlug    String   @map("old_slug")
  newSlug    String   @map("new_slug")
  locale     String
  entityType String
  entityId   String   @map("entity_id")
  createdAt  DateTime @default(now()) @map("created_at")

  @@unique([locale, oldSlug, entityType])
  @@index([locale, oldSlug])
  @@map("slug_redirects")
}
